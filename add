#include <mySimpleComputer.h>
#include <stdlib.h> // Для использования функции malloc и free

int sc_memoryLoad(char *filename) {
    FILE *file = fopen(filename, "rb");

    if (file == NULL) {
        return -1;
    }

    // Создаем временный буфер для данных
    int *temp_memory = (int *)malloc(MEMORY_SIZE * sizeof(int));
    if (temp_memory == NULL) {
        fclose(file);
        return -1; // Ошибка выделения памяти
    }

    // Считываем данные во временный буфер
    size_t elements_read = fread(temp_memory, sizeof(int), MEMORY_SIZE, file);
    fclose(file);

    if (elements_read != MEMORY_SIZE) {
        free(temp_memory);
        return -1; // Ошибка чтения файла
    }

    // Копируем данные из временного буфера в memory
    for (int i = 0; i < MEMORY_SIZE; i++) {
        memory[i] = temp_memory[i];
    }

    // Освобождаем временный буфер
    free(temp_memory);

    return 0;
}
#include <iostream>
#include <vector>
#include <iomanip>

// Параметры модели
struct Params {
    double alphaI, alphaE, kappa, rho, beta, mu, c;
    int N; // Общее количество населения
};

// Основные переменные модели
struct Variables {
    double S, E, I, R, D;
};

// Функция для обновления переменных согласно SEIR-D модели
void seirDModel(Variables& vars, const Params& params, double dt) {
    double newS = vars.S - dt * params.c * (params.alphaI * vars.I * vars.S / params.N + params.alphaE * vars.E * vars.S / params.N);
    double newE = vars.E + dt * params.c * (params.alphaI * vars.I * vars.S / params.N + params.alphaE * vars.E * vars.S / params.N) - dt * (params.kappa + params.rho) * vars.E;
    double newI = vars.I + dt * params.kappa * vars.E - dt * (params.beta + params.mu) * vars.I;
    double newR = vars.R + dt * params.beta * vars.I + dt * params.rho * vars.E;
    double newD = vars.D + dt * params.mu * vars.I;

    // Обновление переменных
    vars.S = newS;
    vars.E = newE;
    vars.I = newI;
    vars.R = newR;
    vars.D = newD;
}

int main() {
    // Инициализация параметров согласно данным из таблицы 11
    Params params = {0.999, 0.999, 0.042, 0.952, 0.999, 0.0188, 1.0, 1000000}; // N - общее количество населения для демонстрации
    Variables vars = {999000, 99, 24, 0, 0}; // Начальные значения E0 и I0 взяты из таблицы, R0 и D0 предполагаются равными нулю

    double t = 0.0, T = 90.0, dt = 0.1;

    std::cout << std::fixed << std::setprecision(2);
    std::cout << "Day\tSusceptible\tExposed\tInfected\tRecovered\tDeceased\n";

    for (int day = 0; t <= T; day++) {
        std::cout << t << "\t" << vars.S << "\t" << vars.E << "\t" << vars.I << "\t" << vars.R << "\t" << vars.D << "\n";
        seirDModel(vars, params, dt);
        t += dt;
    }

    return 0;
}

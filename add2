#include <stdio.h>

// Включите здесь реализацию функции bc_strlen
int bc_strlen(char *str) {
    if (str == NULL) {
        return 0;
    }

    int count = 0;
    unsigned char *p = (unsigned char *)str;

    while (*p) {
        if (*p < 0x80) {
            p += 1;
        } else if ((*p & 0xe0) == 0xc0) {
            if (*(p+1) == 0 || (*(p+1) & 0xc0) != 0x80) return 0;
            p += 2;
        } else if ((*p & 0xf0) == 0xe0) {
            if (*(p+1) == 0 || (*(p+1) & 0xc0) != 0x80 ||
                *(p+2) == 0 || (*(p+2) & 0xc0) != 0x80) return 0;
            p += 3;
        } else if ((*p & 0xf8) == 0xf0) {
            if (*(p+1) == 0 || (*(p+1) & 0xc0) != 0x80 ||
                *(p+2) == 0 || (*(p+2) & 0xc0) != 0x80 ||
                *(p+3) == 0 || (*(p+3) & 0xc0) != 0x80) return 0;
            p += 4;
        } else {
            return 0;
        }
        count++;
    }

    return count;
}

void test_strlen(char *str) {
    int result = bc_strlen(str);
    printf("Testing: '%s'\nResult: %d\n\n", str ? str : "(null)", result);
}

int main() {
    test_strlen("Hello, World!"); // Корректная строка ASCII
    test_strlen("Привет мир"); // Корректная строка в UTF-8
    test_strlen("\xf0\x9f\x8d\x95"); // Корректная строка с эмодзи (пицца)
    test_strlen("\xc3\x28"); // Некорректная строка (неверный второй байт)
    test_strlen(NULL); // Тест на NULL указатель

    return 0;
}
